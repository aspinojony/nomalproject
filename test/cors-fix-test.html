<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORSä¿®å¤æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-lg p-8 max-w-md w-full">
        <h1 class="text-2xl font-bold text-center mb-6">ğŸ”§ CORSä¿®å¤æµ‹è¯•</h1>
        
        <div class="text-center mb-6">
            <p class="text-gray-600 mb-4">æµ‹è¯•ä¿®å¤åçš„AIåŠ©æ‰‹æ˜¯å¦èƒ½æ­£å¸¸åŠ è½½</p>
            <button onclick="testAI()" 
                    class="w-full bg-blue-500 text-white py-3 rounded hover:bg-blue-600 mb-4">
                ğŸš€ å¯åŠ¨AIåŠ©æ‰‹
            </button>
        </div>
        
        <div id="status" class="bg-gray-800 text-green-400 rounded p-4 font-mono text-sm h-40 overflow-y-auto">
            ç­‰å¾…æµ‹è¯•...
        </div>
    </div>

    <!-- åŠ è½½AIåŠ©æ‰‹ -->
    <script src="../assets/js/ai-assistant-loader.js"></script>

    <script>
        function log(message) {
            const status = document.getElementById('status');
            const timestamp = new Date().toLocaleTimeString();
            status.innerHTML += `[${timestamp}] ${message}<br>`;
            status.scrollTop = status.scrollHeight;
            console.log(message);
        }

        function testAI() {
            log('ğŸš€ å¼€å§‹æµ‹è¯•AIåŠ©æ‰‹...');
            
            // æ£€æŸ¥åŠ è½½çŠ¶æ€
            setTimeout(() => {
                log(`AIåŠ©æ‰‹å®ä¾‹: ${!!window.aiAssistant}`);
                log(`AIåŠ©æ‰‹ç±»å‹: ${typeof window.aiAssistant}`);
                log(`showæ–¹æ³•: ${!!window.aiAssistant?.show}`);
                
                if (window.aiAssistant && typeof window.aiAssistant.show === 'function') {
                    log('âœ… AIåŠ©æ‰‹åŠ è½½æˆåŠŸï¼Œæ­£åœ¨æ˜¾ç¤º...');
                    try {
                        window.aiAssistant.show();
                        log('âœ… AIåŠ©æ‰‹æ˜¾ç¤ºæˆåŠŸï¼æ— CORSé—®é¢˜');
                    } catch (error) {
                        log(`âŒ æ˜¾ç¤ºå¤±è´¥: ${error.message}`);
                    }
                } else {
                    log('âŒ AIåŠ©æ‰‹æœªæ­£ç¡®åŠ è½½');
                }
            }, 2000);
        }

        // è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€
        setTimeout(() => {
            log('ğŸ“Š é¡µé¢åŠ è½½å®Œæˆï¼Œæ£€æŸ¥èµ„æºçŠ¶æ€...');
            log(`CSSåŠ è½½: ${!!document.querySelector('link[href*="ai-assistant-float.css"]')}`);
            log(`è„šæœ¬æ•°é‡: ${document.querySelectorAll('script[src*="../assets/js"]').length}`);
        }, 1000);

        // æ•è·é”™è¯¯
        window.addEventListener('error', function(event) {
            if (event.message.includes('CORS')) {
                log('âŒ ä»å­˜åœ¨CORSé”™è¯¯: ' + event.message);
            } else {
                log('âŒ å…¶ä»–é”™è¯¯: ' + (event.error?.message || event.message));
            }
        });
    </script>
</body>
</html>